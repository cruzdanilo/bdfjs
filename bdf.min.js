!function(e){"use strict";function r(e){if(!e||"string"!=typeof e)return e;var r=e.toLowerCase();return(e.indexOf("_")>=0||e.indexOf("-")>=0)&&(r=r.replace(/[-_]+([a-z])/gi,function(e,r){return r.toUpperCase()})),r}function t(e,t){t=t||{};for(var a={},i={},o={meta:a,glyphs:i},n=String(e).split(/\r?\n/),h=[],s=null,d=0;d<n.length;d++){var c=n[d],p=c.split(/\s+/),u=p[0];switch(u){case"STARTFONT":h.push(u),a.version=p[1];break;case"FONT":a.name=p[1];break;case"SIZE":a.size={points:+p[1],resolutionX:+p[2],resolutionY:+p[3]};break;case"FONTBOUNDINGBOX":a.boundingBox={width:+p[1],height:+p[2],x:+p[3],y:+p[4]};break;case"STARTPROPERTIES":h.push(u),a.properties={};break;case"FONT_DESCENT":a.properties.fontDescent=+p[1];break;case"FONT_ASCENT":a.properties.fontAscent=+p[1];break;case"DEFAULT_CHAR":a.properties.defaultChar=+p[1];break;case"ENDPROPERTIES":h.pop(),t.onlymeta&&(d=Number.MAX_VALUE,h=[]);break;case"CHARS":a.totalChars=+p[1];break;case"STARTCHAR":h.push(u),s={name:p[1],bytes:[],bitmap:[]};break;case"ENCODING":s.code=+p[1],s["char"]=String.fromCharCode(+p[1]);break;case"SWIDTH":s.scalableWidthX=+p[1],s.scalableWidthY=+p[2];break;case"DWIDTH":s.deviceWidthX=+p[1],s.deviceWidthY=+p[2];break;case"BBX":s.boundingBox={x:+p[3],y:+p[4],width:+p[1],height:+p[2]};break;case"BITMAP":for(var f=Math.ceil(s.boundingBox.width/8),b=0;b<s.boundingBox.height;b++,d++){var g=n[d+1];s.bitmap[b]=[];for(var l=0;l<f;l++){var v=g.substr(2*l,2),x=parseInt(v,16);s.bytes.push(x);for(var m=7;m>=0;m--)s.bitmap[b][8*l+(7-m)]=x&1<<m?1:0}}break;case"ENDCHAR":h.pop(),i[s.code]=s,s=null;break;case"ENDFONT":h.pop();break;default:if(t.allprops&&"STARTPROPERTIES"===h[h.length-1]){var T=p.slice(1).join(" ").replace(/^"(.*)"$/,"$1");isNaN(T)||(T=+T),a.properties[r(u)]=T}}}if(h.length)throw"Couldn't correctly parse font";return o}function a(e,r,t){if(e&&r){t=t||{};var a=t.kerningBias||0,i=e.meta.boundingBox.height,o=e.meta.boundingBox.y,n=i+o,h=0,s={width:0,height:i};s.width=0,s.height=i;for(var d=0;d<i;d++)s[d]=[];for(var c=0;c<r.length;c++){var p=r[c].charCodeAt(0),u=e.glyphs[p];if(u||(p=e.meta.properties.defaultChar,u=e.glyphs[p]),u||(p="?".charCodeAt(0),u=e.glyphs[p]),!u){var f=Object.keys(e.glyphs);u=e.glyphs[f[0]]}var b=n-u.boundingBox.y-u.boundingBox.height,g=Math.max(u.deviceWidthX,u.boundingBox.width);s.width<-u.boundingBox.x&&(h=-u.boundingBox.x,g+=h);for(var d=0;d<i;d++)for(var l=0;l<g;l++)m=l+s.width,s[d][m]=0;s.width+=g;for(var v=0;v<u.boundingBox.height;v++)for(var x=0;x<u.boundingBox.width;x++){var d=b+v,m=h+u.boundingBox.x+x;s[d][m]|=u.bitmap[v][x]}h+=u.deviceWidthX+a}return s}}function i(e){for(var r={width:e.width,height:e.height},t=e.width-1,a=0,i=e.height-1,o=0,n=0;n<e.height;n++){var h=e[n].indexOf(1);if(h>=0){var s=e[n].lastIndexOf(1);o=Math.max(o,n),i=Math.min(i,n),a=Math.max(a,s),t=Math.min(t,h)}}r.width=a-t+1,r.height=o-i+1;for(var n=i;n<=o;n++)r[n-i]=e[n].slice(t,a);return r}var o=o||{};o.parse=t,o.draw=a,o.trim=i,"function"==typeof define?define.amd&&define(function(){return o}):"undefined"!=typeof module&&module.exports?module.exports=o:window[e]=o}("BDF");